<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>React환경에서 Redux로 비동기 처리 하기 - CH DEVLOG</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="white"><meta name="application-name" content="CH DEV"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="msapplication-TileColor" content="white"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="CH DEV"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="새롭게 공동 창업을 시작한 이후로 개인적으로 공부하고 글 쓸 시간이 확 줄어서 계획했던 글을 쓰지를 못 하고 있다 (거창하게 JS에서 공부하기 어려웠던 부분들을 정리해보겠다고 목차만 써놨는데 공부만 하고 정리하지 못 하고 있다). 연휴를 맞아서 개인적인 시간이 남기도 하고 새로 빌딩 중인 앱에 리덕스를 붙여야 하는 상황이라 개별적으로 평소에 리덕스의 비동기"><meta property="og:type" content="blog"><meta property="og:title" content="React환경에서 Redux로 비동기 처리 하기"><meta property="og:url" content="https://changhoi.kim/posts/etc/redux-async-demo/"><meta property="og:site_name" content="CH DEVLOG"><meta property="og:description" content="새롭게 공동 창업을 시작한 이후로 개인적으로 공부하고 글 쓸 시간이 확 줄어서 계획했던 글을 쓰지를 못 하고 있다 (거창하게 JS에서 공부하기 어려웠던 부분들을 정리해보겠다고 목차만 써놨는데 공부만 하고 정리하지 못 하고 있다). 연휴를 맞아서 개인적인 시간이 남기도 하고 새로 빌딩 중인 앱에 리덕스를 붙여야 하는 상황이라 개별적으로 평소에 리덕스의 비동기"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRe6MxDK7g_9SNVN_KMNdr130TjtEg6XraxMHK7LqufJU2rcka9"><meta property="article:published_time" content="2020-02-03T15:00:00.000Z"><meta property="article:modified_time" content="2020-02-03T15:00:00.000Z"><meta property="article:author" content="changhoi"><meta property="article:tag" content="react"><meta property="article:tag" content="redux"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRe6MxDK7g_9SNVN_KMNdr130TjtEg6XraxMHK7LqufJU2rcka9"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://changhoi.kim/posts/etc/redux-async-demo/"},"headline":"React환경에서 Redux로 비동기 처리 하기","image":[],"datePublished":"2020-02-03T15:00:00.000Z","dateModified":"2020-02-03T15:00:00.000Z","author":{"@type":"Person","name":"changhoi"},"publisher":{"@type":"Organization","name":"CH DEVLOG","logo":{"@type":"ImageObject","url":"https://changhoi.kim/img/logo.jpg"}},"description":"새롭게 공동 창업을 시작한 이후로 개인적으로 공부하고 글 쓸 시간이 확 줄어서 계획했던 글을 쓰지를 못 하고 있다 (거창하게 JS에서 공부하기 어려웠던 부분들을 정리해보겠다고 목차만 써놨는데 공부만 하고 정리하지 못 하고 있다). 연휴를 맞아서 개인적인 시간이 남기도 하고 새로 빌딩 중인 앱에 리덕스를 붙여야 하는 상황이라 개별적으로 평소에 리덕스의 비동기"}</script><link rel="canonical" href="https://changhoi.kim/posts/etc/redux-async-demo/"><link rel="alternate" href="/rss2.xml" title="CH DEVLOG" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-QBSLW6WTZW" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-QBSLW6WTZW');</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.jpg" alt="CH DEVLOG" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="카탈로그" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRe6MxDK7g_9SNVN_KMNdr130TjtEg6XraxMHK7LqufJU2rcka9" alt="React환경에서 Redux로 비동기 처리 하기"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2020-02-03T15:00:00.000Z" title="2020. 2. 4. 오전 12:00:00">2020-02-04</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2020-02-03T15:00:00.000Z" title="2020. 2. 4. 오전 12:00:00">2020-02-04</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/etc/">etc</a></span><span class="level-item">31분안에 읽기 (약 4684 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile">React환경에서 Redux로 비동기 처리 하기</h1><div class="content"><p>새롭게 공동 창업을 시작한 이후로 개인적으로 공부하고 글 쓸 시간이 확 줄어서 계획했던 글을 쓰지를 못 하고 있다 (거창하게 JS에서 공부하기 어려웠던 부분들을 정리해보겠다고 목차만 써놨는데 공부만 하고 정리하지 못 하고 있다). 연휴를 맞아서 개인적인 시간이 남기도 하고 새로 빌딩 중인 앱에 리덕스를 붙여야 하는 상황이라 개별적으로 평소에 리덕스의 비동기를 위한 미들웨어를 공부해보려고 한다. 사실 비동기 처리를 위해서 미들웨어를 사용해야 한다는 것에 대해서 잘 이해를 못 했다. 자바스크립트는 기본적으로 비동기 처리가 간단하게 되는데 왜 비동기를 위한 미들웨어가 필요할까? 라는 생각이 들고 지금 글을 쓰는 과정에서도 그 부분을 해결하기 위한 관점이 가장 클 것 같다. 우선 프로젝트는 <code>CRA</code>를 통해 구성했다. 그리고 필요한 패키지들을 설치했다.</p>
<span id="more"></span>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app . --typescript</span><br><span class="line"></span><br><span class="line">yarn add react-redux redux axios styled-components</span><br><span class="line">yarn add @types/&#123;styled-components,react-redux&#125; -D <span class="comment"># redux는 타입스크립트로 구성되어 있어서 설치할 필요가 없다고 함</span></span><br></pre></td></tr></table></figure>

<h2 id="Redux에-대해서"><a href="#Redux에-대해서" class="headerlink" title="Redux에 대해서"></a>Redux에 대해서</h2><p>리덕스는 너무나 유명한 상태 관리 시스템이다. 상태 관리는 React 프로젝트에서 너무나 필요한 기능이지만, 리덕스라는 개념은 정확하게는 리액트에서만 통용되는 것은 아니고, 그냥 말 그대로 상태를 관리하도록 돕는 일종의 시스템이다. <a target="_blank" rel="external nofollow noopener noreferrer" href="https://redux.js.org/">리덕스를 소개하는 페이지</a>에서는 리덕스의 중요 원칙을 세 가지로 정리했다.</p>
<ol>
<li><p>Single source of truth<br>애플리케이션의 모든 상태는 하나의 스토어 안에 하나의 객체 트리 구조로 저장된다는 의미인데. 디버깅이 쉽고, 여러 곳에서 상태를 관리하지 않아도 된다는 것을 의미한다.</p>
</li>
<li><p>State is read-only<br>애플리케이션의 상태는 항상 읽기 전용이고, 상태를 객체를 직접 조작함으로써 변경할 수 없다는 것을 의미한다. 상태를 변화시키기 위해서는 어떤 일이 발생할지 기술된 <code>Action</code>을 전달하는 것이 유일한 방법이 되어야 한다는 것이다.</p>
</li>
<li><p>Changes are made with pure functions<br><code>Action</code>을 통해 생기는 변화는 순수 함수를 통해서 이루어져야 한다는 의미이다. 이때 변화를 만드는 함수를 리듀서라고 하는데 이 리듀서는 이전 <code>state</code>를 받고 이전 <code>state</code>와는 독립적인 새로운 <code>state</code>를 반환해야 한다.</p>
</li>
</ol>
<p>이 세 가지가 리덕스의 원칙이고, 이 원칙 마지막에 리덕스를 모두 알게 된 것이라고 말한다(?). 사용하다 보면 대충 알게 되지만 엄밀히 틀린 말은 아니라고 생각 되었다. 우리는 상태(<code>state</code>)가 있고, 이를 특정 <code>action</code>을 <code>dispatcher</code>에게 전달 함으로써 다음 상태로 변경시키는 과정을 리듀서로 적용해서 실제로 스토어를 변화시키는 것을 리덕스가 하는 전체 과정이라고 볼 수 있다. 풀어서 쓰다 보니 오히려 비문이 되긴 했지만, 간단한 원리.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.</span><br><span class="line">[STATE]</span><br><span class="line"></span><br><span class="line">2.</span><br><span class="line">dispatch(action) -&gt; reducer(action, STATE) =&gt; NEWSTATE -&gt; STATE = NEWSTATE</span><br></pre></td></tr></table></figure>

<h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p><code>Action</code>은 애플리케이션에서 스토어로 보내는 데이터 묶음이다. 위 도식에서 볼 수 있듯, <code>dispatch(&#123;type: GET_POST&#125;)</code> 처럼 <code>dispatch</code>를 통해 전달할 수 있다. 타입 말고 다른 데이터 들도 넘길 수 있다. 타입은 반드시 필요하고, 나머지는 마음대로지만, 넘겨야 하는 데이터가 적을 수록 좋다고 한다.</p>
<h3 id="Action-Creator"><a href="#Action-Creator" class="headerlink" title="Action Creator"></a>Action Creator</h3><p><code>Action Creator</code>는 이름 그대로 액션을 만들어내는 주체이다. 만들어내는 행위는 당연 함수가 하겠지. <code>Action Creator</code>의 존재는 사실 함수형 프로그래밍의 원칙을 위해 만들어진 개념이 아닌가 싶었다. 대충 예시는 다음과 같다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getPost</span>(<span class="params">id: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="variable constant_">GET_POST</span>,</span><br><span class="line">    id</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">dispatch</span>(<span class="title function_">getPost</span>(id));</span><br></pre></td></tr></table></figure>

<h3 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h3><p>리듀서는 액션에 따라서 스토어의 상태를 변화시키는 함수이다. 이전 상태와 <code>action</code>을 받아서 새로운 <code>state</code>를 내보내기만 하면 역할은 완료이다. 여러 <code>action</code>들이 있기 때문에 보통 리듀서는 <code>switch</code> 문으로 작성되게 된다.</p>
<h3 id="Reducer-function"><a href="#Reducer-function" class="headerlink" title="Reducer function"></a>Reducer function</h3><p>이 부분은 사실 분리 하는 사람도 있고 아닌 사람도 있겠지만, 함수의 Depth가 깊어지는 것을 막고 싶기 때문에 추가한다. 쉽게 말해서 리듀서가 어떻게 동작할지를 따로 분리시키는 것이다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = initalState, action = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">CREATE_POST</span>:</span><br><span class="line">      <span class="comment">// 이부분에 해당하는 걸 함수로 나눠준다.</span></span><br><span class="line">      <span class="title function_">applyCreatePost</span>(state, action)</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      ...</span><br><span class="line">    <span class="attr">default</span>: <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyCreatePost</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h3><p>스토어에서는 애플리케이션의 상태를 저장하고, <code>getState()</code>를 통해서 상태에 접근하게 하고, <code>dispatch(aciton)</code>을 통해 상태를 수정할 수 있게 하고, <code>subscribe(listener)</code>를 통해 리스너를 등록한다. <code>createStore()</code>를 통해서 스토어를 만들 수 있다. <code>createStore(app, initialState)</code> 같은 형태로 사용된다.</p>
<h3 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h3><p>리액트의 경우에 스토어를 모든 컴포넌트에서 불러올 수 있도록 하기 위해서 <code>Provider</code>를 제공해주는 <code>react-redux</code> 패키지가 존재한다. 아래와 같이 hoc 패턴으로 스토어를 제공한다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">PostScreen</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>그리고 컴포넌트의 <code>props</code>에 <code>store</code>와 <code>dispatch</code> 함수를 넣기 위해서 <code>connect</code> 함수를 제공한다.</p>
<h2 id="Redux-ducks-패턴"><a href="#Redux-ducks-패턴" class="headerlink" title="Redux ducks 패턴"></a>Redux ducks 패턴</h2><p>리덕스 앱을 구축하는 과정에서, 리덕스의 여러가지 부분을 파일로 분할하게 되면 여러 파일을 수정해야 하는 경우가 생기기 때문에 그러한 경우를 방지하기 위해 단순하게 하나의 파일에 reducer가 만들어지도록 하는 패턴이다. 규칙은 다음과 같다.</p>
<p>하나의 모듈은</p>
<ol>
<li><strong>항상</strong> <code>reducer</code>라는 이름의 함수를 <code>export default</code> 해야 한다.</li>
<li><strong>항상</strong> 모듈의 <code>actionCreator</code>를 함수 형태로 <code>export</code> 해야 한다.</li>
<li><strong>항상</strong> <code>npm-module-or-app/reducer/ACTION_TYPE</code> 형태의 <code>actionType</code>을 가져와야 한다.</li>
<li><strong>어쩌면</strong> <code>actionType</code>을 <code>UPPER_SNAKE_CASE</code>로 <code>export</code> 할 수 있다. 만약 외부 <code>reducer</code>가 해당 <code>action</code>이 발생하는지를 기다리거나, 재사용할 수 있는 라이브러리로 퍼블리싱 할 경우에</li>
</ol>
<p>간단하게 비동기를 진행하기 전까지의 원칙과 사용 방법 등을 간단하게 정리했다. 그러면 리덕스를 붙이기 전 리액트 앱을 만들고, 리덕스를 붙이는 방식으로 바꾼 다음 비동기를 작성해보고 어떤 문제가 있는지 확인하고, 이 문제를 해결하기 위해서 가장 유명하다는 <code>react-thunk</code> 또는 <code>react-saga</code>를 도입해보자</p>
<h2 id="리덕스를-붙이기-전"><a href="#리덕스를-붙이기-전" class="headerlink" title="리덕스를 붙이기 전"></a>리덕스를 붙이기 전</h2><p>여기서 당시 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/changhoi/redux-async-demo/tree/8865f428bc77232c46061dd6efb828a2c28ae269">코드</a>를 확인할 수 있다.</p>
<p><code>screens/PostScreen</code>을 Container, Presenter 구조로 나눠서 api로 데이터를 받아오는 로직을 <code>PostScreen.tsx</code>에 담고, CSS와 관련된 컴포넌트들을 <code>Presenter.tsx</code>에 담도록 했다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&quot;styled-components&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IProps</span> &#123;</span><br><span class="line">  <span class="attr">postList</span>: <span class="title class_">Array</span>&lt;&#123; <span class="attr">title</span>: <span class="built_in">string</span>; <span class="attr">body</span>: <span class="built_in">string</span>; <span class="attr">id</span>: <span class="built_in">number</span> &#125;&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Presenter</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">IProps</span>&gt; = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; postList &#125; = props;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Wrapper</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Container</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;postList?.length &amp;&amp;</span></span><br><span class="line"><span class="language-xml">          postList.map((post, index) =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">PostDiv</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;post.title&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;post.body&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">PostDiv</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Container</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Wrapper</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Presenter</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Wrapper</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  width: 100%;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  justify-content: center;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Container</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  width: 70%;</span></span><br><span class="line"><span class="string">  display: flex;</span></span><br><span class="line"><span class="string">  flex-direction: column;</span></span><br><span class="line"><span class="string">  justify-content: center;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PostDiv</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  width: 90%;</span></span><br><span class="line"><span class="string">  height: 10rem;</span></span><br><span class="line"><span class="string">  border: 1px solid black;</span></span><br><span class="line"><span class="string">  border-radius: 5px;</span></span><br><span class="line"><span class="string">  margin: 1rem 0;</span></span><br><span class="line"><span class="string">  padding: 0.25rem;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/screen/PostScreen.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Presenter</span> <span class="keyword">from</span> <span class="string">&quot;./Presenter&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Axios</span> <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">ENDPOINTS</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../../../constants&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PostScreen</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [postList, setPostList] = <span class="title function_">useState</span>([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getPost</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: postList &#125; = <span class="keyword">await</span> <span class="title class_">Axios</span>.<span class="title function_">get</span>(<span class="variable constant_">ENDPOINTS</span>.<span class="property">GET_POSTS</span>, &#123;</span><br><span class="line">      <span class="attr">baseURL</span>: <span class="variable constant_">ENDPOINTS</span>.<span class="property">BASE_URL</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">setPostList</span>(postList);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getPost</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Presenter</span> <span class="attr">postList</span>=<span class="string">&#123;postList&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">PostScreen</span>;</span><br></pre></td></tr></table></figure>

<h2 id="리덕스-구성하기"><a href="#리덕스-구성하기" class="headerlink" title="리덕스 구성하기"></a>리덕스 구성하기</h2><p>이 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/changhoi/redux-async-demo/tree/4f145bca9bf90cab4500177185d60c2780d9cd40">링크</a>에서 이 챕터까지 진행한 코드를 확인할 수 있다.</p>
<p>위와 같은 상황에서 글 쓰기와 불러오기를 <code>useEffect</code>에 들어가는 <code>getPost</code>와 같은 형태가 아니라 모듀 리덕스를 통해 동작하도록 바꿔보자.<br><code>src/redux/configureStore.ts</code>를 만들고 아래 폴더에 <code>src/redux/modules/</code>를 만들어서 아래 리덕스 모듈들을 ducks 형태로 만들어서 전체적인 리덕스를 구성해보려고 한다.<br><code>src/redux/modules/post.ts</code>를 만들고 ducks 형태로 리덕스 모듈을 구성하자.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/redux/modules.post.ts</span></span><br><span class="line"><span class="comment">// imports</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">ENDPOINTS</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../../../constants&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Action Types</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">GET_POST</span> = <span class="string">&quot;GET_POST&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">CREATE_POST</span> = <span class="string">&quot;CREATE_POST&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Action Creators</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPost</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">GET_POST</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createPost</span>(<span class="params">title: <span class="built_in">string</span>, content: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">CREATE_POST</span>, title, content &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initial State</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IPost</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">body</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">initialState</span>: &#123; <span class="attr">postList</span>: <span class="title class_">Array</span>&lt;<span class="title class_">IPost</span>&gt;; newPost?: <span class="title class_">IPost</span> &#125; = &#123;</span><br><span class="line">  <span class="attr">postList</span>: []</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = initialState, action: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">GET_POST</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyGetPost</span>();</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">CREATE_POST</span>:</span><br><span class="line">      <span class="keyword">const</span> &#123; title, body &#125; = action <span class="keyword">as</span> <span class="title class_">IPost</span> &amp; &#123; <span class="attr">type</span>: <span class="built_in">string</span> &#125;;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyCreatePost</span>(state, title, body);</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer Functions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyGetPost</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> postList = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="variable constant_">ENDPOINTS</span>.<span class="property">GET_POSTS</span>, &#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="variable constant_">ENDPOINTS</span>.<span class="property">BASE_URL</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    postList</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyCreatePost</span> = <span class="keyword">async</span> (<span class="params">state: <span class="built_in">any</span>, title: <span class="built_in">string</span>, body: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> newPost = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="variable constant_">ENDPOINTS</span>.<span class="property">GET_POSTS</span>, &#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="variable constant_">ENDPOINTS</span>.<span class="property">BASE_URL</span>,</span><br><span class="line">    <span class="attr">body</span>: &#123; title, body &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123; ...state, newPost &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Default Reducer export</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer;</span><br></pre></td></tr></table></figure>

<p><code>useEffect</code>에서 했던 것을 비동기 망한 예시를 위해 모두 <code>reducer</code>로 작성했다. 작성하면서 비동기로 하면 왜 안될 것 같은지를 깨닫게 되었지만 일단 진행해보자. 아래는 <code>configureStore</code>파일이고, 가장 상위 App에 store를 보내는 것으로 수정했다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/redux/configureStore.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> post <span class="keyword">from</span> <span class="string">&quot;./modules/post&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">combineReducers</span>(&#123; post &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(rootReducer, <span class="title function_">applyMiddleware</span>(logger)); <span class="comment">// 두 번째 인수는 초기 상태를 지정할 수 있음</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">PostScreen</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>그러고 나서 실제 스크린에서 사용할 수 있게 <code>props</code>로 <code>dispatch</code> 하는 함수와 <code>store</code>의 <code>state</code>를 넘겨주었다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PostScreen</span> <span class="keyword">from</span> <span class="string">&quot;./PostScreen&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getPost &#125; <span class="keyword">from</span> <span class="string">&quot;../../redux/modules/post&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = (<span class="params">state: <span class="built_in">any</span>, ownProps: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...ownProps,</span><br><span class="line">    ...state</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapDispatchToProps</span> = (<span class="params">dispatch: <span class="built_in">any</span>, ownProps: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...ownProps,</span><br><span class="line">    <span class="attr">getPost</span>: <span class="keyword">async</span> () =&gt; <span class="title function_">dispatch</span>(<span class="title function_">getPost</span>())</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(mapStateToProps, mapDispatchToProps)(<span class="title class_">PostScreen</span>);</span><br></pre></td></tr></table></figure>

<p>컨테이너에 해당하는 <code>PostScreen.tsx</code>는 아래와 같이 수정했다. <code>useEffect</code>를 없애고 클릭하면 스토어가 업데이트 되도록 변경한 모습이다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Presenter</span> <span class="keyword">from</span> <span class="string">&quot;./Presenter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IProps</span> &#123;</span><br><span class="line">  <span class="attr">getPost</span>: <span class="title class_">Function</span>;</span><br><span class="line">  <span class="attr">postList</span>: <span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PostScreen</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; postList, getPost &#125; = props <span class="keyword">as</span> <span class="title class_">IProps</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const getPost = async () =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   const &#123; data: postList &#125; = await Axios.get(ENDPOINTS.GET_POSTS, &#123;</span></span><br><span class="line">  <span class="comment">//     baseURL: ENDPOINTS.BASE_URL</span></span><br><span class="line">  <span class="comment">//   &#125;);</span></span><br><span class="line">  <span class="comment">//   setPostList(postList);</span></span><br><span class="line">  <span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onClick</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">getPost</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Presenter</span> <span class="attr">onClick</span>=<span class="string">&#123;onClick&#125;</span> <span class="attr">postList</span>=<span class="string">&#123;postList&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">PostScreen</span>;</span><br></pre></td></tr></table></figure>

<p>결과적으로 가져오기 버튼을 클릭하면 스토어의 모습이 다음과 같이 변한다.</p>
<p><img src="https://github.com/changhoi/redux-async-demo/raw/master/logImage.png"></p>
<p>스토어의 객체가 <code>Promise</code>가 된 것이다. 이것을 그냥 해결해 보려고 recursive 하게 <code>async</code> <code>await</code>으로 변경도 해봤지만 바뀌지 않았다. 아무튼 이러한 문제가 있다는 것을 알게 된 시도였다.</p>
<h2 id="Redux-thunk"><a href="#Redux-thunk" class="headerlink" title="Redux thunk"></a>Redux thunk</h2><p>이 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/changhoi/redux-async-demo/tree/2f323144d76c20fc019c39dab37b6e8323d6c879">링크</a>에서 <code>thunk</code>로 문제를 해결한 다음 코드를 확인할 수 있다.</p>
<p>일단 미들웨어를 설치해보자</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux-thunk</span><br></pre></td></tr></table></figure>

<p>그러면 이제 <code>saga</code>, <code>thunk</code>를 적용해보도록 하자. 먼저 <code>redux</code> 공식 문서에서 소개하고 있는 <code>redux-thunk</code>를 먼저 도입해보자. <code>Action Creator</code> 부분도 fetching 중인지 나타내는 상태까지 관리하도록 변경했다 (공식 문서에 있는 예시에 나온 그대로) 변경된 내용은 아래와 같다.</p>
<p>먼저 <code>configureStore.ts</code>에 <code>store</code>를 만들어서 <code>export default</code> 변경해주었다. 하는 방식으로 변경했다. 미들웨어 설정도 붙이게 되면 <code>App.tsx</code>에다가 코드를 쓰는 것보다는 여기서 코드를 완성해서 내보내는 게 더 맞는 것 같다고 생각했다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware, combineReducers &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">&quot;redux-logger&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">&quot;redux-thunk&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> post <span class="keyword">from</span> <span class="string">&quot;./modules/post&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootReducer = <span class="title function_">combineReducers</span>(&#123; post &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">createStore</span>(rootReducer, <span class="title function_">applyMiddleware</span>(thunk, logger)); <span class="comment">// 두 번째 인수는 초기 상태를 지정할 수 있음</span></span><br></pre></td></tr></table></figure>

<p>그리고 나서 reducer를 많이 변경 했는데, <code>FETCH_POST_START</code>와 <code>FETCH_POST_END</code>를 만들었고, <code>getPost</code>는 그냥 네트워킹 로직을 처리하는 함수가 되었다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">// Action Creators</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPost</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">async</span> (<span class="attr">dispatch</span>: <span class="title class_">Function</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">startPost</span>());</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: postList &#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="variable constant_">ENDPOINTS</span>.<span class="property">GET_POSTS</span>, &#123;</span><br><span class="line">      <span class="attr">baseURL</span>: <span class="variable constant_">ENDPOINTS</span>.<span class="property">BASE_URL</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">dispatch</span>(<span class="title function_">endPost</span>(postList));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">startPost</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">FETCH_POST_START</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">endPost</span>(<span class="params">postList: <span class="built_in">Array</span>&lt;<span class="built_in">any</span>&gt;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">FETCH_POST_END</span>, <span class="attr">payload</span>: &#123; postList &#125; &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = initialState, action: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">FETCH_POST_END</span>:</span><br><span class="line">      <span class="keyword">const</span> &#123; postList &#125; = action.<span class="property">payload</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyFetchPostEnd</span>(state, postList);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="attr">FETCH_POST_START</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyFetchPostStart</span>(state);</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer Functions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyFetchPostStart</span> = (<span class="params">state: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; ...state, <span class="attr">isFetching</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyFetchPostEnd</span> = (<span class="params">state: <span class="built_in">any</span>, postList: <span class="built_in">Array</span>&lt;<span class="built_in">any</span>&gt;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...state,</span><br><span class="line">    postList,</span><br><span class="line">    <span class="attr">isFetching</span>: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>작성하는 과정에서 <code>thunk</code>가 어떻게 구성되어 있는지 확인하지는 않았는데 시행 착오를 겪고 나니 대충 감이 왔다. 의사코드로 나타내면 아마도 정말 간단하게도 이런 구조가 아닐까 싶다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">thunk</span> = (<span class="params">dispatch, getState, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> action === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">action</span>(dispatch, getState);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> action;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>물론 미들웨어가 다음 단계로 넘어가는 구조가 어떻게 되어 있는지는 확인하지 못 해서 정교한 구조는 아니겠지만, <code>actionCreator</code>로 <code>dispatch(actionCreator())</code>가 되었을 때를 판단하게 되는 것 같다.</p>
<blockquote>
<p>궁금해서 까봤는데 코드가 아주 비슷하긴 하다. 실제로 14줄 짜리 코드라 더 놀라운데 궁금한 사람은 이 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/reduxjs/redux-thunk/blob/master/src/index.js">링크</a>에서 확인해보자.</p>
</blockquote>
<h2 id="Redux-saga"><a href="#Redux-saga" class="headerlink" title="Redux-saga"></a>Redux-saga</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/changhoi/redux-async-demo/tree/36a5a3988b019f6cf8d81506fa74f298a78953cd">여기</a>서 마지막으로 해결한 상태의 코드를 확인해볼 수 있다.</p>
<p>일단 설치먼저 해두고 문서를 또 읽어보기로 했다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add redux-saga</span><br></pre></td></tr></table></figure>

<p>사가 문서를 읽어보면 사이드 이펙트를 쉽게 관리해준다고 표현되어있다. 특히 여러 글에서 실패하는 경우 마치 트랜젝션이 가능한 것처럼 표현하는 글을 한 두 번 본 기억이 있다. 사가는 리덕스의 함수형 프로그래밍적인 특성을 그대로 유지하고 (순수 함수, 상태 변경을 action으로만 등), 비동기적인 로직을 사가에서 맡아서 처리하도록 한다. 여기서 맡아서 처리하도록 한다를 <code>Generator</code>를 사용하도록 만들어져있다. 기본적으로 <code>Generator</code>는 실행 맥락을 함수 중간 중간 떠넘길 수 있도록 구성할 수 있기 때문에 이러한 투트랙 느낌의 비동기 처리가 가능한 것 같다. 아주 Advanced한 경우는 아직 확인해보지 못 했지만, 위와 같은 간단한 예시를 구성하는 것 자체는 크게 어렵지 않았다. 우선 <code>thunk</code> 미들웨어를 <code>saga</code> 미들웨어로 교체했다. (기존에 <code>src/redux/modules/post</code> 아래를 <code>thunkReducer.ts</code>, <code>sagaReducer.ts</code>로 나눴다.)</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/redux/configureStore.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware, combineReducers &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">&quot;redux-logger&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> createSagaMiddleware <span class="keyword">from</span> <span class="string">&quot;redux-saga&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> post, &#123; rootSaga &#125; <span class="keyword">from</span> <span class="string">&quot;./modules/post/sagaReducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sagaMiddleware = <span class="title function_">createSagaMiddleware</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootReducer = <span class="title function_">combineReducers</span>(&#123; post &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">createStore</span>(</span><br><span class="line">  rootReducer,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(sagaMiddleware, logger)</span><br><span class="line">); <span class="comment">// 두 번째 인수는 초기 상태를 지정할 수 있음</span></span><br><span class="line"></span><br><span class="line">sagaMiddleware.<span class="title function_">run</span>(rootSaga);</span><br></pre></td></tr></table></figure>

<p><code>sagaReducer.ts</code>는 다음과 같이 변경되었다. <code>getPost</code> Action Creator를 붙여서 타입과 페이로드만 넘기는 형태로 바뀌었다. (기존 <code>thunk</code> 에서는 <code>api</code>를 동작시키는 함수를 호출해야 했음, 그리고 에러 처리를 위해 FAIL이 추가됨) 그러면서 <code>saga</code>에게는 어떤 Action Type인지에 따라서 비동기 처리를 할 것인지 말 것인지를 listen 하고 있는 형태인 것 같다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; call, put, takeEvery, all &#125; <span class="keyword">from</span> <span class="string">&quot;redux-saga/effects&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">ENDPOINTS</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../../../constants&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Action Types</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">FETCH_POST_FAIL</span> = <span class="string">&quot;FETCH_POST_FAIL&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">FETCH_POST_START</span> = <span class="string">&quot;FETCH_POST_START&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">FETCH_POST_END</span> = <span class="string">&quot;FETCH_POST_END&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">FETCHING_POST</span> = <span class="string">&quot;FETCHING_POST&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Saga</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fetchPost</span> = (<span class="params"></span>) =&gt;</span><br><span class="line">  axios.<span class="title function_">get</span>(<span class="variable constant_">ENDPOINTS</span>.<span class="property">GET_POSTS</span>, &#123; <span class="attr">baseURL</span>: <span class="variable constant_">ENDPOINTS</span>.<span class="property">BASE_URL</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">fetchPostList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: postList &#125; = <span class="keyword">yield</span> <span class="title function_">call</span>(fetchPost);</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">put</span>(&#123; <span class="attr">type</span>: <span class="variable constant_">FETCH_POST_END</span>, <span class="attr">payload</span>: &#123; postList &#125; &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">put</span>(&#123; <span class="attr">type</span>: <span class="variable constant_">FETCH_POST_FAIL</span>, <span class="attr">payload</span>: e &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">postSaga</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">takeEvery</span>(<span class="variable constant_">FETCHING_POST</span>, fetchPostList);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span>* <span class="title function_">rootSaga</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">all</span>([<span class="title function_">postSaga</span>()]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Action Creators</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPost</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">FETCHING_POST</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">startPost</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">FETCH_POST_START</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">endPost</span>(<span class="params">postList: <span class="built_in">Array</span>&lt;<span class="built_in">any</span>&gt;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="variable constant_">FETCH_POST_END</span>, <span class="attr">payload</span>: &#123; postList &#125; &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initial State</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IPost</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">body</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">initialState</span>: &#123; <span class="attr">postList</span>: <span class="title class_">Array</span>&lt;<span class="title class_">IPost</span>&gt;; newPost?: <span class="title class_">IPost</span> &#125; = &#123;</span><br><span class="line">  <span class="attr">postList</span>: []</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state = initialState, action: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">FETCH_POST_END</span>:</span><br><span class="line">      <span class="keyword">const</span> &#123; postList &#125; = action.<span class="property">payload</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyFetchPostEnd</span>(state, postList);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="attr">FETCH_POST_START</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyFetchPostStart</span>(state);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="attr">FETCH_POST_FAIL</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">applyFetchPostFail</span>(state, action.<span class="property">payload</span>);</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer Functions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyFetchPostStart</span> = (<span class="params">state: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; ...state, <span class="attr">isFetching</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyFetchPostEnd</span> = (<span class="params">state: <span class="built_in">any</span>, postList: <span class="built_in">Array</span>&lt;<span class="built_in">any</span>&gt;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...state,</span><br><span class="line">    postList,</span><br><span class="line">    <span class="attr">isFetching</span>: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">applyFetchPostFail</span> = (<span class="params">state: <span class="built_in">any</span>, payload: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> error = &#123; <span class="attr">title</span>: payload.<span class="property">message</span>, <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(payload.<span class="property">stack</span>) &#125;;</span><br><span class="line">  state.<span class="property">postList</span>.<span class="title function_">push</span>(error);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...state</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Default Reducer export</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer;</span><br></pre></td></tr></table></figure>

<p>현재 프로젝트는 <code>src/screens/PostScreen/index.tsx</code>에서 <code>import &#123; getPost &#125; from &quot;../../redux/modules/post/thunkReducer&quot;;</code> 이 부분만 <code>sagaReducer</code>로 바꿔주면 사가로 동작하고 <code>thunkReducer</code>로 두면 <code>thunk</code>로 동작하게 구성되어져 있다. 최종적인 프로젝트는 이 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/changhoi/redux-async-demo">링크</a>에서 확인할 수 있다.</p>
<blockquote>
<p>위 링크에 있는 코드가 최종 버전은 맞지만, README.md는 다듬기 전의 글 모습이다. 글과 README.md의 디테일한 내용이 아마 차이가 있을 수 있다.</p>
</blockquote>
<h2 id="후기"><a href="#후기" class="headerlink" title="후기"></a>후기</h2><p>결과적으로 프로덕트에는 <code>saga</code>를 공부해서 붙이기로 결정했다. 간단하게만 경험했지만, <code>saga</code>는 <code>thunk</code>의 +a를 많이 제공하고 있다. 단순히 <code>thunk</code>가 하는 일을 <code>takeEvery();</code>와 <code>call(API)</code> 정도로 모두 커버 가능 하면서도, 강력한 기능에 대한 예시들을 공식 문서나 advanced 자료에서 쉽게 찾아볼 수 있다는 점, 디테일한 <code>Helper function</code> 등 선택하는 것에 큰 매력을 주기도 했고, <code>actionCreator</code>를 단순하게 유지할 수 있다는 것과 동시에 재사용이 <code>thunk</code>보다는 쉽다는 점 (그냥 리슨하고 있는 제네레이터 함수일 뿐이기 때문에, 종속적이지 않게 짤 수 있다고 생각됨) 등… 두서 없이 생각해내다 보니까 계속 나오는데 강력한 기능을 경험한 다음 <code>saga</code>에 대한 글을 한 번 더 쓸 수 있으면 좋겠다.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://lunit.gitbook.io/redux-in-korean/advanced/asyncactions">https://lunit.gitbook.io/redux-in-korean/advanced/asyncactions</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://mskims.github.io/redux-saga-in-korean/introduction/BeginnerTutorial.html">https://mskims.github.io/redux-saga-in-korean/introduction/BeginnerTutorial.html</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/reactkr/learn-react-in-korean/blob/master/translated/deal-with-async-process-by-redux-saga.md">https://github.com/reactkr/learn-react-in-korean/blob/master/translated/deal-with-async-process-by-redux-saga.md</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://redux-advanced.vlpt.us/2/05.html">https://redux-advanced.vlpt.us/2/05.html</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://ko.javascript.info/generators">https://ko.javascript.info/generators</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://ko.javascript.info/async-iterators-generators">https://ko.javascript.info/async-iterators-generators</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>React환경에서 Redux로 비동기 처리 하기</p><p><a href="https://changhoi.kim/posts/etc/redux-async-demo/">https://changhoi.kim/posts/etc/redux-async-demo/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>changhoi</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-02-04</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2020-02-04</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/react/">react</a><a class="link-muted mr-2" rel="tag" href="/tags/redux/">redux</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" target="_blank" rel="external nofollow noopener noreferrer" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><div class="card"><div class="card-content"><h3 class="title is-5">관련 글</h3><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/red-black-tree/"><img src="https://www.adexchanger.com/wp-content/uploads/2021/05/coding.jpg" alt="Red-Black Tree"></a></figure><div class="media-content"><p class="date"><time datetime="2021-06-30T15:00:00.000Z">2021-07-01</time></p><p class="title"><a href="/posts/etc/red-black-tree/">Red-Black Tree</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/great-operation-creating-react-ui-kit/"><img src="https://upload.wikimedia.org/wikipedia/commons/1/18/React_Native_Logo.png" alt="React UI Kit 만들기 대작전"></a></figure><div class="media-content"><p class="date"><time datetime="2021-02-13T15:00:00.000Z">2021-02-14</time></p><p class="title"><a href="/posts/etc/great-operation-creating-react-ui-kit/">React UI Kit 만들기 대작전</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/rxjs-operator-01/"><img src="/images/2020-09-17-rxjs-quicklearn-02/01.png" alt="RxJS Operator 01 - Creation, Filtering"></a></figure><div class="media-content"><p class="date"><time datetime="2020-09-25T15:00:00.000Z">2020-09-26</time></p><p class="title"><a href="/posts/etc/rxjs-operator-01/">RxJS Operator 01 - Creation, Filtering</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/rxjs-quicklearn-03/"><img src="/images/2020-09-17-rxjs-quicklearn-02/01.png" alt="RxJS 빠르게 배우기 03 - Observer &amp; Subscription &amp; Operator"></a></figure><div class="media-content"><p class="date"><time datetime="2020-09-19T15:00:00.000Z">2020-09-20</time></p><p class="title"><a href="/posts/etc/rxjs-quicklearn-03/">RxJS 빠르게 배우기 03 - Observer &amp; Subscription &amp; Operator</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/rxjs-quicklearn-02/"><img src="/images/2020-09-17-rxjs-quicklearn-02/01.png" alt="RxJS 빠르게 배우기 02 - Observables"></a></figure><div class="media-content"><p class="date"><time datetime="2020-09-16T15:00:00.000Z">2020-09-17</time></p><p class="title"><a href="/posts/etc/rxjs-quicklearn-02/">RxJS 빠르게 배우기 02 - Observables</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/rxjs-quicklearn-01/"><img src="/images/2020-09-17-rxjs-quicklearn-02/01.png" alt="RxJS 빠르게 배우기 01 - Overview"></a></figure><div class="media-content"><p class="date"><time datetime="2020-08-18T15:00:00.000Z">2020-08-19</time></p><p class="title"><a href="/posts/etc/rxjs-quicklearn-01/">RxJS 빠르게 배우기 01 - Overview</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/refactoring-practice/"><img src="https://c0.wallpaperflare.com/preview/600/243/618/javascript-vscode-editor-code.jpg" alt="리팩토링 실습하기"></a></figure><div class="media-content"><p class="date"><time datetime="2020-06-18T15:00:00.000Z">2020-06-19</time></p><p class="title"><a href="/posts/etc/refactoring-practice/">리팩토링 실습하기</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/husky/"><img src="https://cdn-images-1.medium.com/fit/t/1600/480/1*6BjEhSPYwkgeQfpLvHU3BA.png" alt="Husky로 Git hooks 관리하기"></a></figure><div class="media-content"><p class="date"><time datetime="2020-04-07T15:00:00.000Z">2020-04-08</time></p><p class="title"><a href="/posts/etc/husky/">Husky로 Git hooks 관리하기</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/react-redux-hooks/"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRe6MxDK7g_9SNVN_KMNdr130TjtEg6XraxMHK7LqufJU2rcka9" alt="React환경에서 Hooks로 Redux 사용 하기"></a></figure><div class="media-content"><p class="date"><time datetime="2020-02-04T15:00:00.000Z">2020-02-05</time></p><p class="title"><a href="/posts/etc/react-redux-hooks/">React환경에서 Hooks로 Redux 사용 하기</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/etc/shallow-knowledge-of-funtional-programming/"><img src="/images/2019-12-19-shallow-knowledge-of-functional-programming/thumbnail.png" alt="함수형 프로그래밍에 대한 얕은 지식"></a></figure><div class="media-content"><p class="date"><time datetime="2019-12-18T15:00:00.000Z">2019-12-19</time></p><p class="title"><a href="/posts/etc/shallow-knowledge-of-funtional-programming/">함수형 프로그래밍에 대한 얕은 지식</a></p><p class="categories"><a href="/categories/etc/">etc</a></p></div></article></div></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/etc/react-redux-hooks/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">React환경에서 Hooks로 Redux 사용 하기</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/logs/20191231/"><span class="level-item">2019년, 개발 1년 차 회고</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">댓글</h3><div class="fb-comments" data-width="100%" data-href="https://changhoi.kim/posts/etc/redux-async-demo/" data-num-posts="5"></div><script>(function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/ko/sdk.js#xfbml=1&version=v12.0";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars2.githubusercontent.com/u/34329147?s=400&amp;u=9d1b1dc88bc8ee5965f35b0160780264c3619eb6&amp;v=4" alt="Changhoi Kim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Changhoi Kim</p><p class="is-size-6 is-block">Co-Founder of Bayesians</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul, Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives/"><p class="title">73</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories/"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags/"><p class="title">47</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/changhoi" target="_blank" rel="external nofollow noopener noreferrer">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="LinkedIn" href="https://www.linkedin.com/in/changhoi/"><i class="fab fa-linkedin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/changhoi"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Email" href="mailto:changhoi0522@gmail.com"><i class="fas fa-envelope-square"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/backend/"><span class="level-start"><span class="level-item">backend</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/books/"><span class="level-start"><span class="level-item">books</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/database/"><span class="level-start"><span class="level-item">database</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/docker/"><span class="level-start"><span class="level-item">docker</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/essay/"><span class="level-start"><span class="level-item">essay</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/etc/"><span class="level-start"><span class="level-item">etc</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/go/"><span class="level-start"><span class="level-item">go</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/logs/"><span class="level-start"><span class="level-item">logs</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">network</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/os/"><span class="level-start"><span class="level-item">os</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/rust/"><span class="level-start"><span class="level-item">rust</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/serverless/"><span class="level-start"><span class="level-item">serverless</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">카탈로그</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Redux에-대해서"><span class="level-left"><span class="level-item">1</span><span class="level-item">Redux에 대해서</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Action"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Action</span></span></a></li><li><a class="level is-mobile" href="#Action-Creator"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Action Creator</span></span></a></li><li><a class="level is-mobile" href="#Reducer"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">Reducer</span></span></a></li><li><a class="level is-mobile" href="#Reducer-function"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Reducer function</span></span></a></li><li><a class="level is-mobile" href="#Store"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">Store</span></span></a></li><li><a class="level is-mobile" href="#react-redux"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">react-redux</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Redux-ducks-패턴"><span class="level-left"><span class="level-item">2</span><span class="level-item">Redux ducks 패턴</span></span></a></li><li><a class="level is-mobile" href="#리덕스를-붙이기-전"><span class="level-left"><span class="level-item">3</span><span class="level-item">리덕스를 붙이기 전</span></span></a></li><li><a class="level is-mobile" href="#리덕스-구성하기"><span class="level-left"><span class="level-item">4</span><span class="level-item">리덕스 구성하기</span></span></a></li><li><a class="level is-mobile" href="#Redux-thunk"><span class="level-left"><span class="level-item">5</span><span class="level-item">Redux thunk</span></span></a></li><li><a class="level is-mobile" href="#Redux-saga"><span class="level-left"><span class="level-item">6</span><span class="level-item">Redux-saga</span></span></a></li><li><a class="level is-mobile" href="#후기"><span class="level-left"><span class="level-item">7</span><span class="level-item">후기</span></span></a></li><li><a class="level is-mobile" href="#Reference"><span class="level-left"><span class="level-item">8</span><span class="level-item">Reference</span></span></a></li></ul></div></div><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.jpg" alt="CH DEVLOG" height="28"></a><p class="is-size-7"><span>&copy; 2025 changhoi</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="external nofollow noopener noreferrer" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>